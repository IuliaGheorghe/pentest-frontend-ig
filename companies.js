let companies = [
    {
        name: "Allianz",
        industry: "Banking & Finance",
        country: "Germany",
        relevance: 7,
        image: "assets/images/companies-logos/Allianz-Logo.wine.svg",
    },
    {
        name: "Cathay United Bank",
        industry: "Banking & Finance",
        country: "China",
        relevance: 1,
        image: "assets/images/companies-logos/Cathay_United_Bank_logo.svg"
    },
    {
        name: "Yale University",
        industry: "Education",
        country: "United States of America",
        relevance: 10,
        image: "assets/images/companies-logos/Yale_University_logo.svg"

    },
    {
        name: "Johnson & Johnson",
        industry: "Healthcare",
        country: "United Kingdom",
        relevance: 8,
        image: "assets/images/companies-logos/Johnson_and_Johnson_Logo.svg"

    },
    {
        name: "Accenture",
        industry: "Audit & Advisory",
        country: "United Kingdom",
        relevance: 7,
        image: "assets/images/companies-logos/Accenture.svg"

    },
    {
        name: "Deloitte",
        industry: "Audit & Advisory",
        country: "United Kingdom",
        relevance: 7,
        image: "assets/images/companies-logos/Deloitte.svg"

    },
    {
        name: "Intel",
        industry: "Technology & Telecom",
        country: "United States of America",
        relevance: 10,
        image: "assets/images/companies-logos/Intel_logo_(2006-2020).svg"

    },
    {
        name: "Orange",
        industry: "Technology & Telecom",
        country: "France",
        relevance: 9,
        image: "assets/images/companies-logos/Orange_logo.svg"

    },
    {
        name: "Vodafone",
        industry: "Technology & Telecom",
        country: "United Kingdom",
        relevance: 9,
        image: "assets/images/companies-logos/Vodafone_2017_logo.svg"

    },
    {
        name: "U.S. Department of Commerce",
        industry: "Gov & Public Sector",
        country: "United States of America",
        relevance: 10,
        image: "assets/images/companies-logos/Seal_of_the_United_States_Department_of_Commerce.svg"
    }
]

let result = document.getElementById("results");


let orderEl = document.getElementById("order");
let order = orderEl.value;

let countryEl = document.getElementById("country");
let country = countryEl.value;

let industryEl = document.getElementById("industry");
let industry = industryEl.value;

let modeEl = document.getElementById("mode").getElementsByTagName("i")[0];
let showFilter = document.getElementById("show-filter");
let filterContainer = document.getElementById("filters");

showFilter.addEventListener("click", filterContainerDisplay);

function filterContainerDisplay(){

    if(filterContainer.style.display === "flex")
        filterContainer.style.display = "none";
    else
        filterContainer.style.display = "flex";
}


function changeMode(){
    if(modeEl.classList.contains("fa-arrow-down-short-wide"))
        {
            modeEl.classList.remove("fa-arrow-down-short-wide"); 
            modeEl.classList.add("fa-arrow-up-short-wide"); 
        }
    else
        {
            modeEl.classList.remove("fa-arrow-up-short-wide"); 
            modeEl.classList.add("fa-arrow-down-short-wide");
        }
    
    showCompanies();
}

function checkMode(){
    if (modeEl.classList.contains("fa-arrow-down-short-wide"))
        return "descending";
    else
        return "ascending";
}


orderEl.addEventListener("change", showCompanies);
countryEl.addEventListener("change", showCompanies);
industryEl.addEventListener("change", showCompanies);
modeEl.addEventListener("click", changeMode);

function filterResults(country, industry){

    let results = new Array();

    for(let i = 0; i< companies.length; i++)
        if(companies[i].country === country || country === "All countries")
            if(companies[i].industry === industry || industry === "All industries")
                results.push(companies[i]);

    return results;
}

function sortCompanies(results, order, mode){

    if(order==="Default" || order === "Relevance"){

        if(mode === "descending")
            results.sort(function(a, b){return b.relevance-a.relevance});
        else     
            results.sort(function(a, b){return a.relevance-b.relevance});

    }

    else if(order === "Alphabetical"){
        results.sort();

        if(mode === "descending")
            results.reverse();

        }

    return results;

}


function showCompanies(country, industry, order){

    order = orderEl.value;
    country = countryEl.value;
    industry = industryEl.value;
    mode = checkMode();


    resultsToDisplay = filterResults(country, industry);


    if(resultsToDisplay.length){
        result.innerHTML = "";
        let sortedResults = sortCompanies(resultsToDisplay, order, mode);

        for(let i = 0 ; i< sortedResults.length; i++)
            result.innerHTML += '<img src="' + sortedResults[i].image  + '" alt="' + sortedResults[i].name +  '" title="' + sortedResults[i].name + ' is a Pentest-Tools.com customer"  />';
    }
    else
        result.innerHTML = "No Match!";
}

let resetFilters = document.getElementById("reset-filters");

resetFilters.addEventListener("click", resetFiltersFunc)

function resetFiltersFunc(){
    countryEl.value = "All countries";
    industryEl.value = "All industries";
    showCompanies();
}

showCompanies("All countries", "All industries", "Default");